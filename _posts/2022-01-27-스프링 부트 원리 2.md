---
layout: single
title: \[강의요약\] 스프링부트 개념과 활용 - 3부 스프링 부트 원리 (2/3)
date: 2022-01-27 22:57:00 +0900
categories: springboot springboot_getting_started study

---

개인적인 학습을 위한 inflearn - 스프링부트 개념과 활용(백기선) 강의 요약입니다.

개념과 원리 위주로 요약합니다.

[https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81%EB%B6%80%ED%8A%B8/dashboard](https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81%EB%B6%80%ED%8A%B8/dashboard)

[이전 글](https://cherrue.github.io/springboot/springboot_getting_started/study/%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B6%80%ED%8A%B8-%EC%9B%90%EB%A6%AC/) 에서 이어집니다.

# 3부 - Springboot 원리

---

##### 6. 내장 웹 서버 이해
6-1. 스프링 부트는 웹 서버가 아니다. (톰캣, 네티 등이 웹서버)
application.setWebApplicationType(WebApplicationType.NONE); 만 봐도 알 수 있다

6-2. tomcat 을 띄우기

```java
public class Application {
    public static void main(String[] args) throws LifecycleException {
        Tomcat tomcat = new Tomcat();
        tomcat.setPort(8080);

        Context context = tomcat.addContext("", "/");

        HttpServlet servlet = new HttpServlet() {
            @Override
            protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
                PrintWriter writer = resp.getWriter();
                writer.println("<html><head><title>aaa</title></head>");
                writer.println("<body><h1>Hello Tomcat!</h1></body>");
            }
        };
        String servletName = "helloServlet";
        tomcat.addServlet("", servletName, servlet);
        context.addServletMappingDecoded("/hello", servletName);

        tomcat.start();
        tomcat.getServer().await(); // 요청을 기다린다
    }
}

```

6-3. 내장 웹서버를 띄우는 것도 자동 설정의 기능

- 톰캣 만들기, 서블릿 만들기, web mvc 등

spring-boot-autoconfiguration > META-INF > spring.factories

spring-boot-autoconfiguration > ServletWebServerFactoryAutoConfiguration : 서블릿 웹 서버 생성

DispatcherServletAutoConfiguration : http 서블릿을 상속해서 만든 스프링 서블릿. 얘는 소스에 따라 잘 안 바뀌어서 빼둠



##### 7. 내장 웹 서버 응용 1부 : 컨테이너와 포트

자동 설정에 의해 톰캣용 자동 설정이 읽혀짐 -> 톰캣이 컨테이너로 올라간다.

7-1. 다른 서블릿을 쓰고 싶다면?

1. 톰캣 의존성 제거
   - spring-boot-starter-web > org.springframework.boot:spring-boot-starter-tomcat **exclusion**
   - 제거 후 실행하면 웹 어플리케이션으로 올라가지 않음
2. 다른 컨테이너 의존성 추가
   - org.springframework.boot:spring-boot-starter-jetty **dependency 추가**
   - jetty, undertow

7-2. 프로퍼티를 사용한 설정값 변경

1. 어플리케이션 타입 변경 : spring.main.web-application = none
2. 포트 변경 : server.port = 7070 (0을 주면 랜덤으로 사용할 수 있는 포트가 할당)
   1. 설정된 포트 확인 방법 : ApplicationListener로 ServletWebserverInitializedEvent를 받아와서 확인 가능