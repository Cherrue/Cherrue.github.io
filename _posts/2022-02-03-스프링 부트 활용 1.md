---

layout: single
title: \[ê°•ì˜ìš”ì•½\] ìŠ¤í”„ë§ ë¶€íŠ¸ ê°œë…ê³¼ í™œìš© - 4ë¶€ ìŠ¤í”„ë§ ë¶€íŠ¸ í™œìš© (1)
date: 2022-02-02 15:59:00 +0900
categories: lecture_summary springboot springboot_getting_started
toc: true
toc_sticky: true
toc_label: Contents
show_in_home: false
---

ê°œì¸ì ì¸ í•™ìŠµì„ ìœ„í•œ [Inflearn - ìŠ¤í”„ë§ë¶€íŠ¸ ê°œë…ê³¼ í™œìš©](https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81%EB%B6%80%ED%8A%B8/dashboard)(ë°±ê¸°ì„ ) ê°•ì˜ ìš”ì•½ì…ë‹ˆë‹¤.

ê°œë…ê³¼ ì›ë¦¬ ìœ„ì£¼ë¡œ ìš”ì•½í•©ë‹ˆë‹¤.

[ì´ì „ ê¸€](https://cherrue.github.io/springboot/springboot_getting_started/study/%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B6%80%ED%8A%B8-%EC%9B%90%EB%A6%AC-2/) ì—ì„œ ì´ì–´ì§‘ë‹ˆë‹¤.

# 4ë¶€ - ìŠ¤í”„ë§ë¶€íŠ¸ í™œìš©

---

## 1. ìŠ¤í”„ë§ ë¶€íŠ¸ í™œìš© ì†Œê°œ

1-1. Springboot í•µì‹¬ ê¸°ëŠ¥

- SpringApplication
- ì™¸ë¶€ ì„¤ì •, í”„ë¡œíŒŒì¼
- ë¡œê¹…, í…ŒìŠ¤íŠ¸, dev-tools

1-2. ê¸°ìˆ  ì—°ë™

- spring web mvc
- ìŠ¤í”„ë§ ë°ì´í„°, ìŠ¤í”„ë§ ì‹œíë¦¬í‹°
- REST API í´ë¼ì´ì–¸íŠ¸

## 2. SpringApplication 1ë¶€

ìŠ¤í”„ë§ ë¡œê±° ê¸°ë³¸ ê°’ì€ INFO ì´ë‹¤.

VMOption = -Ddebug (program argument = â€”debug) ë¥¼ ì£¼ì–´ì„œ ë³€ê²½í•  ìˆ˜ ìˆë‹¤

ì–´ë–¤ ìë™ ì„¤ì •ì´ ì ìš© ë˜ì—ˆëŠ”ì§€ debug ë¡œê·¸ì— ì°í˜.

2-1. FailureAnalyzer

2-1-1. ë°°ë„ˆ : resources/banner.txt ë¡œ ì»¤ìŠ¤í…€ ê°€ëŠ¥.

application.propertiesì—ì„œ íŒŒì¼ ìœ„ì¹˜ ë³€ê²½. ì¸ì½”ë”©, íŒŒì¼ í˜•ì‹ ë³€ê²½ ë“± ì„¤ì • ê°€ëŠ¥

```bash
.   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::        (v2.2.0.RELEASE)
```

${} ë¡œ ë³€ìˆ˜ê°€ ì‚¬ìš© ê°€ëŠ¥. ì†ŒìŠ¤ë¡œ ì‹¤í–‰í•  ë•ŒëŠ” MANIFEST ë³€ìˆ˜ëŠ” ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ë‹¤.

```bash
# resources/banner.txt
==============================
Cherrue Banner ${spring-boot.version}
==============================

->

==============================
Cherrue Banner 2.2.0.RELEASE
==============================
```

ë°°ë„ˆ ì†ŒìŠ¤ êµ¬í˜„ë„ ê°€ëŠ¥

```java
@SpringBootApplication
public class SpringinitApplication {
    public static void main(String[] args) {
        SpringApplication app = new SpringApplication(SpringinitApplication.class);
        app.setBanner(new Banner() {
            @Override
            public void printBanner(Environment environment, Class<?> sourceClass, PrintStream out) {
                out.println("==================");
                out.println("HELLO");
                out.println("==================");
            }
        });
        app.run(args);
    }
}
```

2-1-2. SpringApplicationBuilder : builder íŒ¨í„´ì´ ì ìš©

static method ì¸ SpringApplication.runì„ ì‚¬ìš©í•˜ë©´ ì»¤ìŠ¤í…€ì„ í•  ìˆ˜ ì—†ë‹¤.

ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“¤ì–´ run í•´ì£¼ê±°ë‚˜ builder ë¥¼ ì‚¬ìš©í•˜ì

```java
@SpringBootApplication
public class SpringinitApplication {
    public static void main(String[] args) {
        new SpringApplicationBuilder()
                .sources(SpringinitApplication.class)
                .run(args);
        // same as
				// SpringApplication app = new SpringApplication(SpringinitApplication.class);
        // app.run(args);
    }
}
```

## 3. SpringApplication 2ë¶€

spring ì—ëŠ” ë‹¤ì–‘í•œ ì‹œì (íƒ€ì´ë°)ì´ ìˆë‹¤. ì´ ì‹œì ì— íŠ¸ë¦¬ê±°ë¥¼ ì¤„ ìˆ˜ ìˆëŠ” ë¦¬ìŠ¤ë„ˆë¥¼ ë§Œë“¤ì–´ë³´ì

3-1. Listener

3-1-1. ì–´í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ ìƒì„± ì´ì „ì˜ ì´ë²¤íŠ¸

```java
// @Component ì´ ë¦¬ìŠ¤ë„ˆëŠ” ë¹ˆì¼ í•„ìš”ê°€ ì—†ë‹¤. ì–´í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ ìƒì„± ì´í›„ì˜ ë¦¬ìŠ¤ë„ˆì—ëŠ” í•„ìš”
public class SampleListener implements ApplicationListener<ApplicationStartingEvent> {
    @Override
    public void onApplicationEvent(ApplicationStartingEvent applicationStartingEvent) {
        System.out.println("=======================");
        System.out.println("Application is Starting");
        System.out.println("=======================");
    }
}
```

âš ï¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ ìƒì„± ì „ì˜ ì´ë²¤íŠ¸ëŠ” ë¹ˆìœ¼ë¡œ ëœ ë¦¬ìŠ¤ë„ˆ ì‚¬ìš©ì´ ë¶ˆê°€ëŠ¥í•´ì„œ ì§ì ‘ ë“±ë¡ì„ í•´ì£¼ì–´ì•¼ í•œë‹¤.

```java
@SpringBootApplication
public class SpringinitApplication {
    public static void main(String[] args) {
        SpringApplication app = new SpringApplication(SpringinitApplication.class);
        app.addListeners(new SampleListener()); // ë“±ë¡
        app.run(args);
    }
}
```

ê²°ê³¼

```java
me.cherrue.SpringinitApplication --debug
=======================
Application is Starting
=======================
2022-02-03 21:10:59.341 DEBUG 27529 --- [           main] .c.l.ClasspathLoggingApplicationListener : Application started with classpath: [ ...
==============================
Cherrue Banner 2.2.0.RELEASE
==============================
2022-02-03 21:10:59.418  INFO 27529 --- [           main] me.cherrue.SpringinitApplication
```

2-1-2. ì–´í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ ìƒì„± ì´í›„ì˜ ì´ë²¤íŠ¸

ì•„ë˜ì™€ ê°™ì´ @Component ë¥¼ ë¶™ì—¬ì„œ Bean ìœ¼ë¡œ ë§Œë“¤ì–´ì£¼ë©´ ì•Œì•„ì„œ ë“±ë¡ì´ ëœë‹¤.

```java
@Component
public class SampleListener implements ApplicationListener<ApplicationStartingEvent> {
    @Override
    public void onApplicationEvent(ApplicationStartingEvent applicationStartingEvent) {
        System.out.println("=======================");
        System.out.println("Application is Starting");
        System.out.println("=======================");
    }
}
```

3-2. WebApplicationType

REACTIVE : servletì´ ìˆì–´ë„ web fluxë¥¼ ì“°ê² ë‹¤ëŠ” ì„¤ì •

```java
app.setWebApplicationType(WebApplicationType.REACTIVE);
```

3-3. Application arguments

Application arguments : Program arguments ë¡œ ë“¤ì–´ì˜¨ ê°’

- Bean ìƒì„±ìì— Bean í•˜ë‚˜ë§Œ ë°›ìœ¼ë©´ ìŠ¤í”„ë§ì´ ì•Œì•„ì„œ ì£¼ì…í•´ì¤€ë‹¤.

```java
@Component
public class ArgumentsPrinter {
    public ArgumentsPrinter(ApplicationArguments args) {
        System.out.println("foo : " + args.containsOption("foo"));
        System.out.println("bar : " + args.containsOption("bar"));
    }
}
```

```java
$ java -jar target/springinit-1.0-SNAPSHOT.jar -Dfoo --bar

2022-02-03 21:21:21.164 DEBUG 27635 --- [           main] o.s.boot.SpringApplication               : Loading source class me.cherrue.SpringinitApplication
foo : false
bar : true
```

3-4. ApplicationRunner

ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•œ í›„ ë¬´ì–¸ê°€ ì‹¤í–‰í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©.

CommandLineRunner ì´ëŸ° ì• ë“¤ë„ ìˆë‹¤. (ì¡°ê¸ˆ ë¬´ì‹í•˜ê²Œ ì ‘ê·¼í•´ì•¼ í•´ì„œ ë¶ˆí¸í•¨)

@Order(ìˆ«ì) ë¥¼ í†µí•´ ì‹¤í–‰ ìˆœì„œë¥¼ ì •í•  ìˆ˜ ìˆìŒ

```java
// ApplicationRunner
@Component
public class ArgumentsRunner implements ApplicationRunner {
    @Override
    public void run(ApplicationArguments args) throws Exception {
        System.out.println("foo : " + args.containsOption("foo"));
        System.out.println("bar : " + args.containsOption("bar"));
    }
}

// CommandLineRunner
@Component
public class ArgumentsRunner implements CommandLineRunner {
    @Override
    public void run(String... args) throws Exception {
			Arrays.stream(args).forEach(System.out::println);
    }
}
```

## 4. ì™¸ë¶€ ì„¤ì • 1ë¶€

4-1. ì„¤ì • ê°’ ìš°ì„ ìˆœìœ„

application.propertiesì˜ ìš°ì„ ìˆœìœ„ëŠ” 15ìœ„ (ì´ 17ìœ„ê¹Œì§€ ìˆìŒ)

ì»¤ë§¨ë“œ ë¼ì¸ ì•„ê·œë¨¼íŠ¸ëŠ” 4ìœ„ (java -jar target/aa.jar â€”myArguments)

test properties : test/resources ìƒì„± + Project Structure > Modules > Test Resources ì§€ì •í•˜ë©´ ê¸°ì¡´ í”„ë¡œí¼í‹° ë®ì–´ì”€

- mainì˜ ë¹Œë“œ ê²°ê³¼ë¥¼ í´ë˜ìŠ¤íŒ¨ìŠ¤ì— ë„£ì€ í›„ í…ŒìŠ¤íŠ¸ì˜ ë¹Œë“œ ê²°ê³¼ë¥¼ ë¶€ì–´ë²„ë¦¬ê¸° ë•Œë¬¸
- í•˜ì§€ë§Œ test/resources/application.propertiesë¥¼ ì“°ë©´ ì›ë˜ í”„ë¡œí¼í‹°ì™€ í•„ë“œë¥¼ ê°™ê²Œ ê°€ì ¸ì•¼ í•˜ë‹ˆ ì£¼ì˜
- @TestPropertySourceì™€ @SpringBootTest(properties=...) ê°€ ê°™ì€ ì—­í• ì´ ê°€ëŠ¥í•˜ë‹ˆ í™œìš©í•  ê²ƒ

âš ï¸ [application.properties](http://application.properties) ì˜ ìœ„ì¹˜ë„ ìš°ì„  ìˆœìœ„ê°€ ë‹¤ë¥´ë‹¤. (./config, ./, classpath:/, classpath:/config)

4-2. ì„¤ì • ê°’ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë°©ë²•

1. @Value ì–´ë…¸í…Œì´ì…˜ ì‚¬ìš©
    
    ```java
    // application.properties
    cherrue.name = "Cherrue"
    
    // SampleRunner.java
    @Component
    public class SampleRunner implements ApplicationRunner {
        @Value("${cherrue.name")
        private String name;
    
        @Override
        public void run(ApplicationArguments args) throws Exception {
            System.out.println("======================");
            System.out.println(name);
            System.out.println("======================");
        }
    }
    ```


## 5. ì™¸ë¶€ ì„¤ì • 2ë¶€

5-1. ì„¤ì • ê°’ì„ í•œ ë²ˆì— ë¶ˆëŸ¬ì˜¤ì

1. @ConfigurationPropertiesì— ê´€ë ¨ ì„¤ì • ê°’ ì„ ì–¸
2. getter / setter êµ¬í˜„
3. SpringbootApplicationì— @EnableConfigurationProperties(CherrueProperties.class) : ë¹ˆ ë“±ë¡ê³¼ ì–´ë…¸í…Œì´ì…˜ ì²˜ë¦¬ - ì•ˆ í•´ë„ ì´ë¯¸ í¬í•¨ë˜ì–´ ìˆìŒ
4. ConfigurationPropertiesì— @Component ë¶™ì´ê¸°
    
    ```java
    // application.properties
    cherrue.name = Cherrue
    cherrue.age = ${random.int(0,100)}
    cherrue.fullName = ${cherrue.name} Lee
    
    // CherrueProperties.java
    @Component
    @ConfigurationProperties("cherrue")
    public class CherrueProperties {
        private String name;
        private int age;
        private String fullName;
    
        public String getName() {
            return name;
        }
    
        public void setName(String name) {
            this.name = name;
        } 
    
        public int getAge() {
            return age;
        }
    
        public void setAge(int age) {
            this.age = age;
        }
    
        public String getFullName() {
            return fullName;
        }
    
        public void setFullName(String fullName) {
            this.fullName = fullName;
        }
    }
    ```
    
5. ì„¤ì •ê°’ ì‚¬ìš©ì²˜ì—ì„œ @Autowiredë¡œ ë¶ˆëŸ¬ì˜¨ í”„ë¡œí¼í‹° í˜¸ì¶œ = getter/setter ë°˜í™˜í˜• ëª…ì‹œë¡œ type safe
    
    ```java
    @Component
    public class SampleRunner implements ApplicationRunner {
        @Autowired
        CherrueProperties cherrueProperties;
        @Override
        public void run(ApplicationArguments args) throws Exception {
            System.out.println("======================");
            System.out.println(cherrueProperties.getName());
            System.out.println("======================");
        }
    }
    ```
    

ğŸ“ŒÂ Tips.Â dependencyì— spring-boot-configuration-processorë¥¼ ì¶”ê°€í•˜ë©´ properties íŒŒì¼ì—ì„œ ìë™ ì™„ì„±ì´ ëœë‹¤

## 6. ì™¸ë¶€ ì„¤ì • 3ë¶€

6-1. ìœµí†µì„± ìˆëŠ” ë°”ì¸ë”©

full-name, full_name, fullName ëª¨ë‘ ë°”ì¸ë”© ì•Œì•„ì„œ ë¨

6-2. í”„ë¡œí¼í‹° íƒ€ì… ì»¨ë²„ì „

cherrue.age = 100 â‡’ @Value(â€${cherrue.age}â€) int age;

Propertiesì—ëŠ” ìë£Œí˜•ì´ ëª¨ë‘ ë¬¸ìì—´ì´ì§€ë§Œ, springì´ ì œê³µí•˜ëŠ” ê¸°ë³¸ì ì¸ íƒ€ì… ì»¨ë²„ì „ì„ í†µí•´ ì•Œì•„ì„œ ë¶™ì—¬ì¤€ë‹¤.

1. íŠ¹ìˆ˜í•œ ì»¨ë²„ì „ : @DurationUnit
    
    ```java
    // application.properties
    cherrue.name = Cherrue
    cherrue.age = ${random.int(0,100)}
    cherrue.fullName = ${cherrue.name} Lee
    cherrue.sessionTimeout=25
    # ë˜ëŠ” cherrue.sessionTimeout=25s
    # s suffix ë¥¼ ì“°ë©´ ì–´ë…¸í…Œì´ì…˜ ì—†ì´ë„  durationìœ¼ë¡œ ì„¤ì • ê°€ëŠ¥
    
    // CherrueProperties.java
    @Component
    @ConfigurationProperties("cherrue")
    public class CherrueProperties {
        String name;
        int age;
        String fullName;
        
        @DurationUnit(ChronoUnit.SECONDS)
        private Duration sessionTimeout = Duration.ofSeconds(30);
    
        public Duration getSessionTimeout() {
            return sessionTimeout;
        }
    
        public void setSessionTimeout(Duration sessionTimeout) {
            this.sessionTimeout = sessionTimeout;
        }
    ...
    }
    ```
    
    ì‹¤í–‰ê²°ê³¼
    
    ```java
    ======================
    Cherrue
    81
    PT25S
    ======================
    ```
    
6-3. í”„ë¡œí¼í‹° ê°’ ê²€ì¦

[JSR-303](https://beanvalidation.org/1.0/spec/#constraintsdefinitionimplementation-constraintdefinition) Bean validation 1.0ì˜ ê²€ì¦ì´ ê°€ëŠ¥(@NotEmpty, @Size ë“±)

```java
// application.properties
cherrue.name = 
cherrue.age = ${random.int(0,100)}
cherrue.fullName = ${cherrue.name} Lee
cherrue.sessionTimeout=25

// CherrueProperties.java
@Component
@ConfigurationProperties("cherrue")
@Validated
public class CherrueProperties {
    @NotEmpty
    String name;
    int age;
    String fullName;
...
}
```

ì‹¤í–‰ê²°ê³¼

```java
Binding to target org.springframework.boot.context.properties.bind.BindException: Failed to bind properties under 'cherrue' to me.cherrue.CherrueProperties failed:

    Property: cherrue.name
    Value: 
    Origin: class path resource [application.properties]:2:0
    Reason: ë°˜ë“œì‹œ ê°’ì´ ì¡´ì¬í•˜ê³  ê¸¸ì´ í˜¹ì€ í¬ê¸°ê°€ 0ë³´ë‹¤ ì»¤ì•¼ í•©ë‹ˆë‹¤.
```